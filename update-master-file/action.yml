name: 'Update Master File and Open PR'
description: 'Fetches the requirements-master, commits, and creates a PR'
inputs:
  target-file-url:
    description: 'URL of the target file to fetch'
    required: false
    default: 'https://raw.githubusercontent.com/PangeaResearch/pangea-ppm/main/requirements-master.txt'
  commit-message:
    description: 'Commit message'
    required: false
    default: 'Update requirements-master.txt'
  branch-name:
    description: 'Branch name for the new branch'
    required: false
    default: 'update-requirements-master'
  pr-title:
    description: 'Title for the PR'
    required: false
    default: 'Update requirements-master.txt'
  pr-body:
    description: 'Body for the PR'
    required: false
    default: 'Update requirements-master.txt'

runs:
  using: 'composite'    
  steps:
  - name: Fetch requirements-master file
    shell: bash
    run: |
      curl -sL -H "Authorization: token $GITHUB_TOKEN" ${{ inputs.target-file-url }} > requirements-master.txt
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  - name: Create Pull Request
    uses: PangeaResearch/create-pull-request@main
    with:
      commit-message: ${{ inputs.commit-message }}
      title: ${{ inputs.pr-title }}
      body: ${{ inputs.pr-body }}
      base: main
      branch: ${{ inputs.branch-name }}
      delete-branch: true
